<!-- app/views/cover_letters/new.html.erb -->

<% content_for :head do %>
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- HTML Styling -->
  <style>
    /* Loading Placeholder Glow Effect */
    .placeholder-glow .placeholder {
      animation: placeholder-glow 2s ease-in-out infinite;
    }
    /* Highlight Resume */
    .resume-highlight {
      background-color: lightblue;
    }
    /* Highlight Job Description */
    .job-highlight {
      background-color: lightgreen;
    }
  </style>
<% end %>

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <h1 class="text-center mb-4">Unique Cover Letter Generator</h1>

      <%= form_tag('/generate_cover_letter', method: 'post', class: 'mb-4', id: 'cover-letter-form') do %>
        <div class="mb-3">
          <label for="resume" class="form-label">Resume:</label>
          
          <div class="input-group">
            <%= text_area_tag :resume, nil, { :rows => 10, :class => 'form-control', :required => true, :id => 'resume-textarea' } %>
            
            <button type="button" class="btn btn-secondary" id="load-resume-btn">Load Resume</button>
          </div>
        </div>

        <div class="mb-3">
          <label for="job_description" class="form-label">Job Description:</label>
          
          <div class="input-group">
            <%= text_area_tag :job_description, nil, { :rows => 10, :class => 'form-control', :required => true, :id => 'job-description-textarea' } %>
            
            <button type="button" class="btn btn-secondary" id="load-job-description-btn">Load Job Description</button>
          </div>
        </div>

        <div class="text-center">
          <%= submit_tag 'Generate Cover Letter', class: 'btn btn-primary', id: 'submit-btn' %>
        </div>
      <% end %>

      <%= render 'shared/placeholder' %>

      <div id="generated-cover-letter-container" class="d-none">
        <h2 class="text-center mb-3">Generated Cover Letter:</h2>
        
        <div id="generated-cover-letter" class="border p-3 mb-3" contenteditable="true"></div>

        <div class="d-flex justify-content-center mb-3 gap-3">
          <button id="copy-btn" class="btn btn-outline-success">Copy to Clipboard</button>
          
          <%= link_to 'Generate Another', ucl_test_path, { :class => 'btn btn-outline-danger' } %>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal for selecting job descriptions -->
<div class="modal fade" id="jobDescriptionModal" tabindex="-1" aria-labelledby="jobDescriptionModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="jobDescriptionModalLabel">Select Job Description</h5>
        
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <ul id="job-description-list" class="list-group">
          <!-- Job descriptions will be appended here -->
        </ul>
      </div>
      
      <div class="modal-footer">  
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<%= render 'shared/javascript' %>
